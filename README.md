# planner-cpsat

Временная модель планирования по линиям с OR-Tools CP-SAT, Excel COM и Tkinter GUI.

## Возможности
- Читает из активной книги Excel:
  - `JOBS!JobsTable` → JobID, Line, Name, Volume, Quantity, Speed, Priority, Строгий порядок
  - `Карта_Переходов` (блочная матрица)
  - `Таблица_Нормативов!StdStops` (минуты и "следующий запуск" по ключам)
- По каждой линии строит расписание во времени (Sequence + NoOverlap c учётом переходов).
- Учитывает строгие ключи (сохранение локальных порядков) и приоритеты (жёсткие предшествования).
- Минимизирует makespan линии → эквивалентно минимизации простоев (производственные длительности фиксированы).
- Формирует событийную ленту: Запуск → Переход → Производство.

## Установка
```bash
py -3 -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```

## Запуск GUI
```bash
python gui_app.py
```

## Запуск CLI
```bash
python cli.py --start "29.09.2025 08:00" --csv out.csv
# Дополнительно можно указать --file "C:\path\to\file.xlsx" для открытия книги
```

## Ожидаемая структура Excel
- Лист `JOBS` с таблицей `JobsTable` (колонки: JobID, Line, Name, Volume, Quantity, Speed, Priority, [Строгий порядок|StrictKey])
- Лист `Карта_Переходов` (блочная матрица по линиям)
- Лист `Таблица_Нормативов` с таблицей `StdStops`:
  - Колонка `Event|Событие`
  - Остальные колонки — заголовки вида `Линия 1`, `Линия 2`, ...
  - Значения ячеек — число минут или `минуты;следующий_запуск`.

## Лицензия
MIT
